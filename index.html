<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head>
	<link rel="stylesheet" href="./CSS/jquery-ui.css" />
	<link href="./CSS/main.css?ve=6" rel="stylesheet" type="text/css" />
	<script type = "text/javascript" src="./JQ/jquery.min.js"></script>
	<script type = "text/javascript" src="./JQ/jquery-ui.min.js"></script>
	<script type = "text/javascript" src="./JQ/jquery.ui.touch-punch.min.js"></script>
	<script type = "text/javascript" src="./JQ/mousetrap.min.js"></script>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<TITLE>Binaural Beats & Tones</TITLE>
	<META NAME="keywords" content="brainwaves re-trainment, alpha, beta, theta, gamma, binaural beats, isochronic tones, nonaural beats, bilateral, white noise, focus, study, relax, anxiety, stress, meditation, sleep, dream, lucid dreaming">
	<meta name="theme-color" content="#0077aa">

	
	
</head>

<body onload="init();showTopMenuButtons();">

<div class="background"></div>

<div id="myNav" class="overlayNav">
  <div id="menuLinks" class="navCentered">

 	 <p><img src="./Pix/ba_logo.png" class="logo"></p>
	  <div class="navLink" onclick="goTo('welcome')">Introduction</div>
	  <div class="navLink" onclick="goTo('brainwaves')">Brainwaves</div>
	  <div class="navLink" onclick="goTo('entrainment')">Entrainment</div>
	  <div class="navLink" onclick="toURL(1);closeNav();">Audio File Download</div>
	  <div class="navLink" onclick="goTo('player')">Back to Player</div>
 </div>
	
</div>

<div id="myWarning" class="overlayWarning">
<div id="warning" class="navCentered">
<p>Click to Start Playing!</p>
<p><img src="./Pix/headphoneBlack.png" width="25%" style="opacity:1;cursor:pointer;"></p>
</div>
</div>

<div id="hamburger"></div><div class="anchor" id="player"></div>

<div class="tile1">
	<a href="https://Infuzik.com" class="nounderline"><div id="title"><img src="./Pix/ba_logo.png" class="logo"> <span class="black">Infuzik</span><span class="white">Binaural</span><span class="reg">&reg;</span></div></a>
<div id="subtitle"><span class="white">Ultimate</span> <span class="black">Brainwaves</span></div>	<div class="ctrSection">
		<img src="./Pix/mute.png" class="ctrlImg" id="mute" onclick="muteOutput()" onmouseover="msg('Muting the Audio Output')" alt="">
		<img src="./Pix/link.png" class="ctrlImg" onclick="toURL()" onmouseover="msg('Save or Share current settings in a custom URL')" alt="">
		<img src="./Pix/alien.png" class="ctrlImg" onclick="newSet('anything')" onmouseover="msg('Anything can happen! (Randomize)')" alt="">
		<img src="./Pix/wav.png" class="ctrlImg" onclick="toURL(1)" onmouseover="msg('Generate a high quality standalone audio file')" alt="">
</div>
		
	
<div class="group black">
		<div class="sliderGroup"><span class="label black">brainwave</span><div id="mod"></div><input type="text" id="modval" onfocus="this.value=''" onKeyDown="if(event.keyCode==13) setSliderMod(this.value);"></div>
		</div>
		<span class="black">&darr;</span>
		<div class="group white">
		<div class="sliderGroup"><span class="label black">a-mod</span><div id="isochronic"></div><input type="text" id="isoval" onfocus="this.value=''" onKeyDown="if(event.keyCode==13) setSliderIso(this.value);"></div>
		<div class="sliderGroup"><span class="label black">binaural</span><div id="binaural"></div><input type="text" id="binval" onfocus="this.value=''" onKeyDown="if(event.keyCode==13) setSliderBin(this.value);"></div>
		<div class="sliderGroup"><span class="label black">stereo</span><div id="bilateral"></div><input type="text" id="bilval" onfocus="this.value=''" onKeyDown="if(event.keyCode==13) setSliderBil(this.value);"></div>
		<div class="sliderGroup"><span class="label black">f-mod</span><div id="fm"></div><input type="text" id="fmval" onfocus="this.value=''" onKeyDown="if(event.keyCode==13) setSliderFm(this.value);"></div>
		</div>
		<span class="white">&uarr;</span>
		<div class="group white">
		<div class="sliderGroup"><span class="label white">carrier</span><div id="carrier"></div><input type="text" id="carval" onfocus="this.value=''" onKeyDown="if(event.keyCode==13) setSliderCar(this.value);"></div>
		<div class="sliderGroup"><span class="label white">noise</span><div id="noise"></div><input type="text" id="noiseval" onfocus="this.value=''" onKeyDown="if(event.keyCode==13) setSliderNoise(this.value);"></div>
		</div>
		&nbsp;
		<div class="group white">
		<div class="sliderGroup"><span class="label black">mix level</span><div id="level"></div><input type="text" id="levval" onfocus="this.value=''" onKeyDown="if(event.keyCode==13) setSliderLvl(this.value);"></div>
</div>
		
<div class="ctrSection">
		<img src="./Pix/1.png" id="g0" class="selImg" onclick="setG(0)" onmouseover="msg('Edit Generator 1')" alt="">
		<img src="./Pix/2.png" id="g1" class="selImg" onclick="setG(1)" onmouseover="msg('Edit Generator 2')" alt="">
		<img src="./Pix/3.png" id="g2" class="selImg" onclick="setG(2)" onmouseover="msg('Edit Generator 3')" alt="">
		<img src="./Pix/4.png" id="g3" class="selImg" onclick="setG(3)" onmouseover="msg('Edit Generator 4')" alt="">
		<img src="./Pix/5.png" id="g4" class="selImg" onclick="setG(4)" onmouseover="msg('Edit Generator 5')" alt="">
		<img src="./Pix/multi.png" id="gm" class="selImg" onclick="setG('m')" onmouseover="msg('Multi Edit')" alt="">
</div>
		
<div id="msg">Interactive Text Display</div>
	
<div class="ctrSection">
				<img src="./Pix/sleep.png" class="ctrlImg" onclick="newSet('sleep')" onmouseover="msg('Brainwaves for <b class=\'mod\'>Deep Sleep</b>')" alt="">
				<img src="./Pix/dream.png" class="ctrlImg" onclick="newSet('dream')" onmouseover="msg('Brainwaves for <b class=\'mod\'>Dream</b>')" alt="">
				<img src="./Pix/creative.png" class="ctrlImg" onclick="newSet('creative')" onmouseover="msg('Brainwaves for <b class=\'mod\'>Creativity</b>')" alt="">
				<img src="./Pix/relax.png" class="ctrlImg" onclick="newSet('relax')" onmouseover="msg('Brainwaves for <b class=\'mod\'>Relaxation</b>')" alt="">
				<img src="./Pix/productivity.png" class="ctrlImg" onclick="newSet('productivity')" onmouseover="msg('Brainwaves for <b class=\'mod\'>Productivity</b>')" alt="">
				<img src="./Pix/alert.png" class="ctrlImg" onclick="newSet('alert')" onmouseover="msg('Brainwaves for <b class=\'mod\'>Focus</b>')" alt="">
				<br>
				<img src="./Pix/focus_3.jpg" class="ctrlImg" onclick="newSet('hyperfocus')" onmouseover="msg('Brainwaves for <b class=\'mod\'>Hyper Focus</b>')" alt="">
				<img src="./Pix/Gamma.png" class="ctrlImg" onclick="newSet('gamma')" onmouseover="msg('Brainwaves for <b class=\'mod\'>Hi-Gamma</b>')" alt="">
				<img src="./Pix/hearing.png" class="ctrlImg" onclick="newSet('hearing')" onmouseover="msg('Retrain your <b class=\'mod\'>Hearing</b>!')" alt="">
</div>
		
<div id="radioTouch"></div></div>

<div class="anchor" id="audiofile"></div>




<script>

// params
var TABS=5;
var G; // current gen
var MULTI=0;
var CARRIER=[220,30,150,432,9000]; //Hz
var FCARMIN=27.5;
var FMODMIN=0.1;
var OCTCAR=9;
var OCTMOD=10;
var MOD=[1,0.5,1.95,3,0.2]; //Hz
var ISOCHRONIC=[50,100,0,0,100]; //%
var BINAURAL=[100,100,100,0,100]; //%
var BILATERAL=[100,0,0,100,100]; //%
var FM=[0,100,0,0,100]; //%
var LEVEL=[50,0,0,0,0]; //%
var NOISE=[0,0,0,0,0]
var bWEBAUDIO=0;
var bSUSPENDED=0;
var bMute=0;
var msgTimer;

// WEBAUDIO ELEMENTS
var context;
var oscL=[];
var oscR=[];
var noiseL=[];
var noiseR=[];
var lfo=[];
var lfoHalf=[];
var gainL=[];
var gainR=[];
var merger=[];
var gainI=[];
var bilatGain=[];
var noiseGainL=[];
var noiseGainR=[];
var noiseGainRL=[];
var noiseGainRR=[];
var filterL=[];
var filterR=[];
var oscGainL=[];
var oscGainR=[];
var bilatInvertedGain=[];
var lfoGain=[];
var fmGain=[];
var filterGain=[];
var gainGlobal=[];


function webAudioContextCheck() {
	if(context.state == "suspended") {
		bSUSPENDED=1;
		document.getElementById("myWarning").onclick = resumeContext;
		openWarning();
	}
}


function resumeContext(){
	 context.resume(); 
	 document.getElementById("myWarning").removeAttribute("onclick");
	 bSUSPENDED=0;
	 closeWarning();
}

function init() {

	// Startup checks
	
	// Supports WebAudio?
	if(typeof webkitAudioContext !== "undefined") bWEBAUDIO=1;
	if(typeof AudioContext !== "undefined") bWEBAUDIO=1;
	
	if (bWEBAUDIO) {
	
		
		if (typeof AudioContext !== 'undefined') context= new AudioContext();
		else context = new webkitAudioContext();
		
		
		for (var t=0;t<TABS;t++) {
		
		// creating oscillators
		oscL[t]=context.createOscillator();
		oscL[t].type='sine';
		oscL[t].frequency.value=CARRIER[t]+MOD[t]/2*BINAURAL[t]/100; // value in hertz
		
		oscR[t]=context.createOscillator();
		oscR[t].type='sine';
		oscR[t].frequency.value=CARRIER[t]-MOD[t]/2*BINAURAL[t]/100; // value in hertz
		
		lfo[t]=context.createOscillator();
		lfo[t].type='sine';
		lfo[t].frequency.value=MOD[t]; // value in hertz
		lfoHalf[t]=context.createOscillator();
		lfoHalf[t].type='sine';
		lfoHalf[t].frequency.value=MOD[t]/2; // value in hertz
		
		// noises
		
		var bufferSize = 6 * context.sampleRate,
			noiseBuffer = context.createBuffer(1, bufferSize, context.sampleRate),
			output = noiseBuffer.getChannelData(0);
		for (var i = 0; i < bufferSize; i++) {
			output[i] = 3*(Math.random() * 2 - 1);
		}

		noiseL[t]=context.createBufferSource();
		noiseL[t].buffer=noiseBuffer;
		noiseL[t].loop=true;
		noiseR[t]=context.createBufferSource();
		noiseR[t].buffer=noiseBuffer;
		noiseR[t].loop=true;
		
		// filters for the noise
		filterR[t] = context.createBiquadFilter();
		filterL[t] = context.createBiquadFilter();
		filterR[t].type = "bandpass";
		filterR[t].frequency.value = CARRIER[t];
		filterR[t].Q.value = 2;
		filterL[t].type = "bandpass";
		filterL[t].frequency.value = CARRIER[t];
		filterL[t].Q.value = 2;
		
		// tone+noise
		noiseGainL[t]=context.createGain();
		noiseGainR[t]=context.createGain();
		noiseGainRL[t]=context.createGain();
		noiseGainRR[t]=context.createGain();
		oscGainL[t]=context.createGain();
		oscGainR[t]=context.createGain();
		noiseGainL[t].gain.value=0;
		noiseGainR[t].gain.value=0;
		oscGainL[t].gain.value=1;
		oscGainR[t].gain.value=1;
		noiseGainRL[t].gain.value=0;
		noiseGainRR[t].gain.value=1;
		noiseL[t].connect(noiseGainL[t]);
		noiseL[t].connect(noiseGainRL[t]);
		noiseR[t].connect(noiseGainRR[t]);
		noiseGainRR[t].connect(noiseGainR[t]);
		noiseGainRL[t].connect(noiseGainR[t]);
		noiseGainL[t].connect(filterL[t]);
		noiseGainR[t].connect(filterR[t]);
		oscL[t].connect(oscGainL[t]);
		oscR[t].connect(oscGainR[t]);

		// creating gain nodes and connecting them to the oscs
		bilatGain[t]=context.createGain();
		bilatGain[t].gain.value=BILATERAL[t]/100*0.25; 
		bilatInvertedGain[t]=context.createGain();
		bilatInvertedGain[t].gain.value=-1;
		bilatGain[t].connect(bilatInvertedGain[t]);
		lfoHalf[t].connect(bilatGain[t]);

		lfoGain[t]=context.createGain(); // lfo[t] varies between -1 and 1
		lfo[t].connect(lfoGain[t]); // we will couple lfo[t] with lfoGain[t] to change the output range
		
		fmGain[t]=context.createGain();
		fmGain[t].gain.value=FM[t]/100*CARRIER[t];
		filterGain[t]=context.createGain();
		filterGain[t].gain.value=FM[t]/150*CARRIER[t]; 
		lfo[t].connect(fmGain[t]);
		lfo[t].connect(filterGain[t]);
		fmGain[t].connect(oscL[t].frequency);
		fmGain[t].connect(oscR[t].frequency);
		filterGain[t].connect(filterL[t].frequency);
		filterGain[t].connect(filterR[t].frequency);

		gainL[t]=context.createGain();
		gainR[t]=context.createGain();
		gainI[t]=context.createGain();
		gainL[t].gain.value=0.25;
		gainR[t].gain.value=0.25;
		bilatInvertedGain[t].connect(gainL[t].gain);
		bilatGain[t].connect(gainR[t].gain);
		
		gainI[t].gain.value=0.5;
		lfoGain[t].connect(gainI[t].gain);
		lfoGain[t].gain.value=ISOCHRONIC[t]/100*gainI[t].gain.value; 
		
		oscGainL[t].connect(gainL[t]);
		oscGainR[t].connect(gainR[t]);
		filterL[t].connect(gainL[t]);
		filterR[t].connect(gainR[t]);
		
		merger[t]=context.createChannelMerger(2);
		merger[t].connect(gainI[t]);
				
		gainL[t].connect(merger[t],0,0);
		gainR[t].connect(merger[t],0,1);
		
		gainGlobal[t]=context.createGain();
		gainGlobal[t].gain.value=LEVEL[t]/100;
		gainI[t].connect(gainGlobal[t]);
		gainGlobal[t].connect(context.destination);
		
		// everything is ready and connected, start!
		lfo[t].start();
		lfoHalf[t].start();
		oscL[t].start();
		oscR[t].start();
		noiseR[t].start(0,3);
		noiseL[t].start();
		}
		
		
	}
	else alert('Web Audio API is missing. To enjoy Brainaural, please use a recent version of Chrome, Edge, Safari or Firefox (basically everything but Internet Explorer).');

	buildUI();
	setG(0);
	
  	// Suspended Policy by Mobile Browsers and Chrome!
	setTimeout(function() {webAudioContextCheck();}, 500);	// race condition, set in a timer
	
setLevel(LEVEL[G],G);


}


function buildUI(){
	$(function(){$("#carrier").slider({
        animate: "fast",
        min: 0,
        max: OCTCAR,
        step:0.01,
        slide: function(e, ui) {
          setCarrier(Math.pow(2,ui.value)*FCARMIN);
        }
      });} );
      
      $(function(){$("#noise").slider({
        animate: "fast",
        min: 0,
        max: 100,
        step:1,
        slide: function(e, ui) {
          setNoise(ui.value);
        }
      });} );
      
      $(function(){$("#mod").slider({
        animate: "fast",
        min: 0,
        max: OCTMOD,
        step:0.01,
        slide: function(e, ui) {
          setMod(Math.pow(2,ui.value)*FMODMIN);
        }
      });} );
      
      $(function(){$("#binaural").slider({
        animate: "fast",
        min: 0,
        max: 100,
        step: 1,
        slide: function(e, ui) {
          setBinaural(ui.value);
        }
      });} );
      
      $(function(){$("#bilateral").slider({
        animate: "fast",
        min: 0,
        max: 100,
        step: 1,
        slide: function(e, ui) {
          setBilateral(ui.value);
        }
      });} );
      
      $(function(){$("#isochronic").slider({
        animate: "fast",
        min: 0,
        max: 100,
        step: 1,
        slide: function(e, ui) {
          setIsochronic(ui.value);
        }
      });} );
      
      $(function(){$("#fm").slider({
        animate: "fast",
        min: 0,
        max: 100,
        step: 1,
        slide: function(e, ui) {
          setFm(ui.value);
        }
      });} );
    
      $(function(){$("#level").slider({
        animate: "fast",
        min: 0,
        max: 100,
        step: 1,
        slide: function(e, ui) {
          setLevel(ui.value);
        }
      });} );
}

function setCarrier(val,g,bNoMsg){
	if(typeof g === "undefined") g=G;
	if (MULTI) for (var t=0;t<TABS;t++) setSingleCarrier(val,t,bNoMsg);
	else setSingleCarrier(val,g,bNoMsg);
}

function setMod(val,g,bNoMsg){
	if(typeof g === "undefined") g=G;
	if (MULTI) for (var t=0;t<TABS;t++) setSingleMod(val,t,bNoMsg);
	else setSingleMod(val,g,bNoMsg);
}

function setBinaural(val,g,bNoMsg){
	if(typeof g === "undefined") g=G;
	if (MULTI) for (var t=0;t<TABS;t++) setSingleBinaural(val,t,bNoMsg);
	else setSingleBinaural(val,g,bNoMsg);
}

function setBilateral(val,g,bNoMsg){
	if(typeof g === "undefined") g=G;
	if (MULTI) for (var t=0;t<TABS;t++) setSingleBilateral(val,t,bNoMsg);
	else setSingleBilateral(val,g,bNoMsg);
}

function setIsochronic(val,g,bNoMsg){
	if(typeof g === "undefined") g=G;
	if (MULTI) for (var t=0;t<TABS;t++) setSingleIsochronic(val,t,bNoMsg);
	else setSingleIsochronic(val,g,bNoMsg);
}

function setFm(val,g,bNoMsg){
	if(typeof g === "undefined") g=G;
	if (MULTI) for (var t=0;t<TABS;t++) setSingleFm(val,t,bNoMsg);
	else setSingleFm(val,g,bNoMsg);
}

function setNoise(val,g,bNoMsg){
	if(typeof g === "undefined") g=G;
	if (MULTI) for (var t=0;t<TABS;t++) setSingleNoise(val,t,bNoMsg);
	else setSingleNoise(val,g,bNoMsg);
}

function setLevel(val,g,bNoMsg){
	if(typeof g === "undefined") g=G;
	if (MULTI) for (var t=0;t<TABS;t++) setSingleLevel(val,t,bNoMsg);
	else setSingleLevel(val,g,bNoMsg);
}

function setSingleCarrier(val,t,bNoMsg){
	CARRIER[t]=val;
	oscL[t].frequency.value=CARRIER[t]-MOD[t]/2*BINAURAL[t]/100;
	oscR[t].frequency.value=CARRIER[t]+MOD[t]/2*BINAURAL[t]/100;
	filterL[t].frequency.value=CARRIER[t];
	filterR[t].frequency.value=CARRIER[t];
	
	fmGain[t].gain.value=FM[t]/100*CARRIER[t];
	filterGain[t].gain.value=FM[t]/150*CARRIER[t];
	var fmax=Math.pow(2,OCTCAR)*FCARMIN;
	gainI[t].gain.value=0.5*(1-0.5*CARRIER[t]/fmax)*(1-0.6*CARRIER[t]/fmax);
	$("#carval").val(parseInt(val)+'Hz');
	if (!bNoMsg){
		if (val>1000) msg("A high as you can hear!");
		else msg("Make it low, but still audible");
	}
}

function setSingleMod(val,t,bNoMsg){
var cT=context.currentTime;
	MOD[t]=val;
	oscL[t].frequency.value=CARRIER[t]+val/2*BINAURAL[t]/100;
	oscR[t].frequency.value=CARRIER[t]-val/2*BINAURAL[t]/100;
	lfo[t].frequency.setTargetAtTime(val,cT,0.001); // Safari bug, next line didn't work
	//lfo[t].frequency.value=val;
	lfoHalf[t].frequency.setTargetAtTime(val/2,cT,0.001); // Safari bug, next line didn't work
	//lfoHalf[t].frequency.value=val/2;
	$("#modval").val(parseInt(val*100)/100+'Hz'); //This is where the 100 max slide right is set
	var text;
	if (val<0.5)text="Ultra-Low Delta";
	if (val>0.5)text="Delta";
	if (val>4)text="Theta";
	if (val>8)text="Alpha";
	if (val>12)text="Beta";
	if (val>30)text="Gamma";
	if (val>60)text="High Gamma";
	if (!bNoMsg) msg(text);
}

function setSingleBinaural(val,t,bNoMsg){
	BINAURAL[t]=val;
	oscL[t].frequency.value=CARRIER[t]+MOD[t]/2*BINAURAL[t]/100;
	oscR[t].frequency.value=CARRIER[t]-MOD[t]/2*BINAURAL[t]/100;
	noiseGainRR[t].gain.value=val/100;
	noiseGainRL[t].gain.value=1-val/100;
	$("#binval").val(parseInt(val)+'%');
	if (!bNoMsg) msg('Best for Headphones');
}

function setSingleBilateral(val,t,bNoMsg){
	BILATERAL[t]=val;
	bilatGain[t].gain.value=BILATERAL[t]/100*0.25;
	$("#bilval").val(parseInt(val)+'%');
	if (!bNoMsg) msg('For Stereo Speakers and Headphones');
}

function setSingleIsochronic(val,t,bNoMsg){
	ISOCHRONIC[t]=val;
	lfoGain[t].gain.value=ISOCHRONIC[t]/100*gainI[t].gain.value;
	$("#isoval").val(parseInt(val)+'%');
	if (!bNoMsg) msg('Best for Single Speaker use');
}

function setSingleFm(val,t,bNoMsg){
	FM[t]=val;
	fmGain[t].gain.value=FM[t]/100*CARRIER[t];
	filterGain[t].gain.value=FM[t]/150*CARRIER[t];
	$("#fmval").val(parseInt(val)+'%');
	if (!bNoMsg) msg('Works with everything!');
}

function setSingleNoise(val,t,bNoMsg){
	NOISE[t]=val;
	noiseGainL[t].gain.value=val/100;
	noiseGainR[t].gain.value=val/100;
	oscGainL[t].gain.value=1-val/100;
	oscGainR[t].gain.value=1-val/100;
	$("#noiseval").val(parseInt(val)+'%');
	if (!bNoMsg) msg('Works with everything!');
}

function setSingleLevel(val,t,bNoMsg){
	LEVEL[t]=val;
	gainGlobal[t].gain.value=LEVEL[t]*LEVEL[t]/10000;
	$("#levval").val(parseInt(val)+'%');
	if (!bNoMsg){
		if (LEVEL>0.5) msg("A loud as you want, but not louder!");
		else msg("As quiet as you want, but audible");
	}
}

function setSliderMod(val,g){
	if(typeof g === "undefined") g=G;
	val=parseFloat(val);
	$("#mod").slider('value',Math.log2(val/FMODMIN));
	setSingleMod(val,g,1);
}

function setSliderIso(val,g){
	if(typeof g === "undefined") g=G;
	val=parseFloat(val);
	$("#isochronic").slider('value',val);
	setSingleIsochronic(val,g,1);
	}
	
function setSliderBin(val,g){
	if(typeof g === "undefined") g=G;
	val=parseFloat(val);
	$("#binaural").slider('value',val);
	setSingleBinaural(val,g,1);
}

function setSliderBil(val,g){
	if(typeof g === "undefined") g=G;
	val=parseFloat(val);
	$("#bilateral").slider('value',val);
	setSingleBilateral(val,g,1);
}

function setSliderFm(val,g){
	if(typeof g === "undefined") g=G;
	val=parseFloat(val);
	$("#fm").slider('value',val);
	setSingleFm(val,g,1);
}

function setSliderCar(val,g){
	if(typeof g === "undefined") g=G;
	val=parseFloat(val);
	$("#carrier").slider('value',Math.log2(val/FCARMIN));
	setSingleCarrier(val,g,1);
}

function setSliderLvl(val,g){
	if(typeof g === "undefined") g=G;
	val=parseFloat(val);
	$("#level").slider('value',val);
	setSingleLevel(val,g,1);
}

function setSliderNoise(val,g){
	if(typeof g === "undefined") g=G;
	val=parseFloat(val);
	$("#noise").slider('value',val);
	setSingleNoise(val,g,1);
}

function setSliders(mod,car,noi,iso,bin,bil,fm,g){
	if(typeof g === "undefined") g=G;
	setSliderMod(mod,g);
	setSliderCar(car,g);
	setSliderNoise(noi,g);
	setSliderIso(iso,g);
	setSliderBin(bin,g);
	setSliderBil(bil,g);
	setSliderFm(fm,g);
}

function refreshSliders(g){
	if (MULTI) {
		// no need to do anything actually
	}
	else {
		$("#mod").slider('value',Math.log2(MOD[g]/FMODMIN));
		$("#modval").val(parseInt(MOD[g]*100)/100+'Hz');
		$("#carrier").slider('value',Math.log2(CARRIER[g]/FCARMIN));
		$("#carval").val(parseInt(CARRIER[g]*100)/100+'Hz');
		$("#noise").slider('value',NOISE[g]);
		$("#noiseval").val(parseInt(NOISE[g])+'%');
		$("#isochronic").slider('value',ISOCHRONIC[g]);
		$("#isoval").val(parseInt(ISOCHRONIC[g])+'%');
		$("#binaural").slider('value',BINAURAL[g]);
		$("#binval").val(parseInt(BINAURAL[g])+'%');
		$("#bilateral").slider('value',BILATERAL[g]);
		$("#bilval").val(parseInt(BILATERAL[g])+'%');
		$("#fm").slider('value',FM[g]);
		$("#fmval").val(parseInt(FM[g])+'%');
		$("#level").slider('value',LEVEL[g]);
		$("#levval").val(parseInt(LEVEL[g])+'%');
	}
}

function msg(txt){
		$("#msg").html(txt);
		clearTimeout(msgTimer);
		msgTimer = setTimeout(function(){msg("<b class='mod'>Scroll down</b> for more instructions...")}, 5000);
}


function newSet(setting){
	var mod,car,iso,bin,bil,fm;
	var fmin,fmax;
	mod=MOD[G];car=CARRIER[G];iso=ISOCHRONIC[G];bin=BINAURAL[G];bil=BILATERAL[G];fm=FM[G];
	var start,end;
	var noi=1;
	if (MULTI) {start=0;end=TABS}
	else {start=G;end=G+1;}
	for (var t=start;t<end;t++) {
		switch (setting) {
		case "anything":
			mod=Math.pow(2,Math.random()*OCTMOD)*FMODMIN;
			car=Math.pow(2,Math.random()*Math.random()*OCTCAR)*FCARMIN;
			iso=Math.floor(Math.random()*100);bin=Math.floor(Math.random()*100);bil=Math.floor(Math.random()*100);fm=Math.floor(Math.random()*100);noi=Math.floor(Math.random()*100);
			break;
		case "sleep":
			fmin=0.25;fmax=2;
			mod=(fmax-fmin)*Math.random()+fmin;
			break;
		case "dream":
			fmin=2;fmax=6;
			mod=(fmax-fmin)*Math.random()+fmin;
			break;
		case "creative":
			fmin=6;fmax=8;
			mod=(fmax-fmin)*Math.random()+fmin;
			break;
		case "relax":
			fmin=8;fmax=14;
			mod=(fmax-fmin)*Math.random()+fmin;
			break;
		case "productivity":
			fmin=14;fmax=20;
			mod=(fmax-fmin)*Math.random()+fmin;
			break;
		case "alert":
			fmin=20;fmax=60;
			mod=(fmax-fmin)*Math.random()+fmin;
			break;
		case "hyperfocus":
			fmin=14;fmax=20;
			mod=76;
			iso=67;
			bin=43;
			bil=63;
			fm=37;
			car=100;
			break;
		case "gamma":
			fmin=14;fmax=20;
			mod=102.4;
			iso=50;
			bin=100;
			bil=0;
			fm=0;
			car=100;
			break;
		case "hearing":
			fmin=8000;fmax=14000;
			car=(fmax-fmin)*Math.random()+fmin;
			fmin=1;fmax=30;
			mod=(fmax-fmin)*Math.random()+fmin;
			bin=0;
			bil=Math.floor(Math.random()*100);
			iso=Math.floor(Math.random()*100);
			fm=100;
			break;
		}
		setSliders(mod,car,noi,iso,bin,bil,fm,t);
	}
}

function setG(mode){
	if (mode=="m") {
		for (var t=0;t<TABS;t++) {
			$("#g"+t).addClass("active");
		}
		MULTI=1;
		G=0;
	}
	else {
		for (var t=0;t<TABS;t++) {
			$("#g"+t).removeClass("active");
		}
		$("#g"+mode).addClass("active");
		G=mode;
		MULTI=0;
	}
	refreshSliders(G);
}

function muteOutput(){
	bMute=!bMute;
	if (bMute) {
		$("#mute").addClass("superactive");
		for (var t=0;t<TABS;t++) gainGlobal[t].gain.value=0;
	}
	else {
		$("#mute").removeClass("superactive");
		for (var t=0;t<TABS;t++) gainGlobal[t].gain.value=LEVEL[t]*LEVEL[t]/10000;
	}
}

function toURL(bRender){
	var url='https://infuzik.com/play.php?';
		url+="mod0="+MOD[0];
		url+="&car0="+CARRIER[0];
		url+="&noi0="+NOISE[0];
		url+="&iso0="+ISOCHRONIC[0];
		url+="&bin0="+BINAURAL[0];
		url+="&bil0="+BILATERAL[0];
		url+="&fm0="+FM[0];
		url+="&lvl0="+LEVEL[0];
	for (var t=1;t<TABS;t++) {
		url+="&mod"+t+"="+MOD[t];
		url+="&car"+t+"="+CARRIER[t];
		url+="&noi"+t+"="+NOISE[t];
		url+="&iso"+t+"="+ISOCHRONIC[t];
		url+="&bin"+t+"="+BINAURAL[t];
		url+="&bil"+t+"="+BILATERAL[t];
		url+="&fm"+t+"="+FM[t];
		url+="&lvl"+t+"="+LEVEL[t];
	}
	if (bRender==1) {
		// update the rendering linl
		url+="&render=1";
		window.open(url);
	}
	else // must then be for copying the embedded URL settings
	window.prompt('This URL embeds all your settings. Press [Ctrl+C] to Copy', url);
}

// Keypresses

Mousetrap.bind('m', function() { muteOutput(); });
Mousetrap.bind('1', function() { setG(0); });
Mousetrap.bind('2', function() { setG(1); });
Mousetrap.bind('3', function() { setG(2); });
Mousetrap.bind('4', function() { setG(3); });
Mousetrap.bind('5', function() { setG(4); });


</script> <script>
// Screen management

function openNav() {
	$("#hamburger").css('background-image', 'url("Pix/close.png")');
    document.getElementById("myNav").style.left = 0;
    $("#hamburger").unbind('click').click(closeNav);
}

function closeNav() {
	$("#hamburger").css('background-image', 'url("Pix/hamburger.png")');
    document.getElementById("myNav").style.left = "-100%";
    $("#hamburger").unbind('click').click(openNav);
}

function goTo(id) {
    closeNav();
    document.getElementById(id).scrollIntoView();
}

function showTopMenuButtons() {
	$("#hamburger").css('background-image', 'url("Pix/hamburger.png")');
	$("#hamburger").addClass('upperLeft show');
	$("#hamburger").unbind('click').click(openNav);
}

function openWarning() {
    document.getElementById("myWarning").style.right = 0;
}

function closeWarning() {
    document.getElementById("myWarning").style.right = "-100%";
}

</script>

</body>
</html>
